# This example bundle produces a small, stand-alone swift deployment
# as a test fixture for a dev/test environment where openstack is
# deployed on top of openstack using the Juju openstack provider.
#
# This bundle is not intended for production use.
series: xenial
applications:
  fixture-swift-proxy:
    charm: cs:swift-proxy
    num_units: 1
    options:
      zone-assignment: manual
      replicas: 3
  fixture-swift-storage-z1:
    charm: cs:swift-storage
    num_units: 1
    options:
      zone: 1
      block-device: /dev/vdb
      overwrite: "true"
      ephemeral-unmount: "/mnt"
  fixture-swift-storage-z2:
    charm: cs:swift-storage
    num_units: 1
    options:
      zone: 2
      block-device: /dev/vdb
      overwrite: "true"
      ephemeral-unmount: "/mnt"
  fixture-swift-storage-z3:
    charm: cs:swift-storage
    num_units: 1
    options:
      zone: 3
      block-device: /dev/vdb
      overwrite: "true"
      ephemeral-unmount: "/mnt"
  fixture-mysql:
    charm: 'cs:percona-cluster'
    num_units: 1
    options:
      innodb-buffer-pool-size: 256M
      max-connections: 1000
  fixture-keystone:
    charm: 'cs:keystone'
    num_units: 1
    options:
      admin-password: openstack
      openstack-origin: 'cloud:xenial-queens'
      worker-multiplier: 0.25
relations:
  - [ fixture-keystone, fixture-mysql ]
  - [ fixture-swift-proxy, fixture-keystone ]
  - [ fixture-swift-proxy, fixture-swift-storage-z1 ]
  - [ fixture-swift-proxy, fixture-swift-storage-z2 ]
  - [ fixture-swift-proxy, fixture-swift-storage-z3 ]
